<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Register/Login Portal</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #eee;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 30px;
  }
  input, button {
    padding: 8px;
    margin: 5px 0;
    width: 200px;
  }
  button {
    cursor: pointer;
  }
  #forbiddenPage {
    text-align: center;
  }
  #forbiddenPage button {
    background: red;
    color: white;
    font-weight: bold;
    border: none;
    padding: 12px 24px;
    border-radius: 6px;
    box-shadow: 0 0 12px red;
    transition: 0.3s;
  }
  #forbiddenPage button:hover {
    background: darkred;
    transform: scale(1.05);
  }
  #switchBtns button {
    background: #333;
    color: #eee;
    border: none;
    border-radius: 5px;
    margin: 0 10px;
    padding: 8px 14px;
    font-weight: bold;
  }
  #switchBtns button:hover {
    background: #555;
  }
  #message {
    height: 20px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>

<div id="registerPage">
  <h2>Register</h2>
  <input type="text" id="regUsername" placeholder="Username" autocomplete="off" />
  <input type="password" id="regPassword" placeholder="Password" autocomplete="off" />
  <button id="registerBtn">Register</button>
  <div id="registerMessage"></div>
  <div id="switchBtns">
    <button id="toLoginBtn">Switch to Login</button>
  </div>
</div>

<div id="loginPage" style="display:none;">
  <h2>Login</h2>
  <input type="text" id="loginUsername" placeholder="Username" autocomplete="off" />
  <input type="password" id="loginPassword" placeholder="Password" autocomplete="off" />
  <button id="loginBtn">Login</button>
  <div id="loginMessage"></div>
  <div id="switchBtns">
    <button id="toRegisterBtn">Switch to Register</button>
  </div>
</div>

<div id="forbiddenPage" style="display:none;">
  <h2>Welcome, Chosen One</h2>
  <button id="openForbiddenBtn">Open the forbidden mohab link</button>
</div>

<script>
  // Simple persistent storage of users
  const usersKey = 'mohab_users';
  let users = JSON.parse(localStorage.getItem(usersKey)) || {};

  // Elements
  const registerPage = document.getElementById('registerPage');
  const loginPage = document.getElementById('loginPage');
  const forbiddenPage = document.getElementById('forbiddenPage');

  const regUsername = document.getElementById('regUsername');
  const regPassword = document.getElementById('regPassword');
  const registerBtn = document.getElementById('registerBtn');
  const registerMessage = document.getElementById('registerMessage');
  const toLoginBtn = document.getElementById('toLoginBtn');

  const loginUsername = document.getElementById('loginUsername');
  const loginPassword = document.getElementById('loginPassword');
  const loginBtn = document.getElementById('loginBtn');
  const loginMessage = document.getElementById('loginMessage');
  const toRegisterBtn = document.getElementById('toRegisterBtn');

  const openForbiddenBtn = document.getElementById('openForbiddenBtn');

  function saveUsers() {
    localStorage.setItem(usersKey, JSON.stringify(users));
  }

  function clearRegisterFields() {
    regUsername.value = '';
    regPassword.value = '';
    registerMessage.textContent = '';
  }

  function clearLoginFields() {
    loginUsername.value = '';
    loginPassword.value = '';
    loginMessage.textContent = '';
  }

  function showRegister() {
    registerPage.style.display = 'block';
    loginPage.style.display = 'none';
    forbiddenPage.style.display = 'none';
    clearRegisterFields();
    clearLoginFields();
  }

  function showLogin() {
    registerPage.style.display = 'none';
    loginPage.style.display = 'block';
    forbiddenPage.style.display = 'none';
    clearLoginFields();
    clearRegisterFields();

    // Make sure the login page shows full normal login form (including switch to register button)
    toRegisterBtn.style.display = 'inline-block';
    loginUsername.style.display = 'inline-block';
    loginPassword.style.display = 'inline-block';
    loginBtn.style.display = 'inline-block';
  }

  function showForbidden() {
    registerPage.style.display = 'none';
    loginPage.style.display = 'none';
    forbiddenPage.style.display = 'block';
  }

  // Register
  registerBtn.addEventListener('click', () => {
    const username = regUsername.value.trim();
    const password = regPassword.value;
    if (!username || !password) {
      registerMessage.style.color = 'red';
      registerMessage.textContent = 'Please enter username and password';
      return;
    }
    if (users[username]) {
      registerMessage.style.color = 'red';
      registerMessage.textContent = 'Username already exists';
      return;
    }
    users[username] = password;
    saveUsers();
    registerMessage.style.color = 'lime';
    registerMessage.textContent = 'Registered successfully! Redirecting to login...';
    clearRegisterFields();

    // Immediately switch to login page (like pressing "Switch to Login")
    showLogin();
  });

  toLoginBtn.addEventListener('click', showLogin);
  toRegisterBtn.addEventListener('click', showRegister);

  // Login
  loginBtn.addEventListener('click', () => {
    const username = loginUsername.value.trim();
    const password = loginPassword.value;
    if (!username || !password) {
      loginMessage.style.color = 'red';
      loginMessage.textContent = 'Enter username and password';
      return;
    }
    if (!users[username] || users[username] !== password) {
      loginMessage.style.color = 'red';
      loginMessage.textContent = 'Wrong username or password';
      return;
    }

    // Successful login
    loginMessage.textContent = '';
    clearLoginFields();

    // Hide login inputs and switch button
    loginUsername.style.display = 'none';
    loginPassword.style.display = 'none';
    loginBtn.style.display = 'none';
    toRegisterBtn.style.display = 'none';

    // Show forbiddenPage with button only (no switch to register)
    showForbidden();
  });

  openForbiddenBtn.addEventListener('click', () => {
    window.open('https://docs.google.com/document/d/17V0c42kK7rWt0fQr4QscPvdpojCMGOrtaEppNhSznmE/edit?usp=sharing', '_blank');
    // Reset login page to normal for next time
    showLogin();
  });

  // Start with register page as you wanted
  showRegister();
</script>
</body>
</html>
